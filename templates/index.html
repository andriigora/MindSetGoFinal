<!-- Co-Edited by CHatGPT 5 -->
{% extends "base.html" %}
{% block title %}MindSetGo â€” Welcome{% endblock %}

{% block content %}
<div class="container narrow">
  {% if form_type == 'register' %}
    <section class="card">
      <h1 class="h1">Create your account</h1>
      <p class="muted">Start tracking habits and earning streaks.</p>
      <form class="form-grid" method="post" action="{{ url_for('register') }}">
        <label>
          <span>Username</span>
          <input name="username" required maxlength="80" placeholder="Your display name">
        </label>
        <label>
          <span>Email</span>
          <input type="email" name="email" required placeholder="you@example.com">
        </label>
        <label>
          <span>Password</span>
          <input type="password" name="password" required minlength="8" placeholder="Min 8 chars with A/a/0/!">
        </label>
        <label>
          <span>Confirm password</span>
          <input type="password" name="confirm_password" required minlength="8">
        </label>
        <button class="btn btn-primary">Create account</button>
        <p class="muted small">Already have an account? <a href="{{ url_for('login') }}">Log in</a></p>
      </form>
    </section>

  {% elif form_type == 'dashboard' %}
    <section class="card">
      <h1 class="h1">Account</h1>
      <div class="stack gap-6">
        <div class="inline-stats">
          <div class="stat">
            <div class="stat-label">Username</div>
            <div class="stat-value">{{ user.username }}</div>
          </div>
          <div class="stat">
            <div class="stat-label">Email</div>
            <div class="stat-value">{{ user.email }}</div>
          </div>
          <div class="stat">
            <div class="stat-label">Points</div>
            <div class="stat-value">{{ user.points }}</div>
          </div>
        </div>

        <details class="details">
          <summary>Change username</summary>
          <form class="form-inline" method="post" action="{{ url_for('change_username') }}">
            <input name="new_username" required maxlength="80" placeholder="New username">
            <button class="btn btn-primary">Save</button>
          </form>
        </details>

        <details class="details">
          <summary>Change password</summary>
          <form class="form-grid" method="post" action="{{ url_for('change_password') }}">
            <label>
              <span>Current password</span>
              <input type="password" name="current_password" required>
            </label>
            <label>
              <span>New password</span>
              <input type="password" name="new_password" required minlength="8">
            </label>
            <button class="btn btn-primary">Update password</button>
          </form>
        </details>

        <details class="details danger">
          <summary>Delete account</summary>
          <form method="post" action="{{ url_for('delete_account') }}" onsubmit="return confirm('Permanently delete your account?');">
            <button class="btn btn-danger">Delete my account</button>
          </form>
        </details>
      </div>
    </section>

  {% else %}
    <section class="card">
      <h1 class="h1">Welcome back</h1>
      <p class="muted">Log in to continue your streaks.</p>
      <form class="form-grid" method="post" action="{{ url_for('login') }}">
        <label>
          <span>Email</span>
          <input type="email" name="email" required placeholder="you@example.com">
        </label>
        <label>
          <span>Password</span>
          <input type="password" name="password" required>
        </label>
        <button class="btn btn-primary">Log in</button>
        <div class="row-between small">
          <a href="{{ url_for('forgot_password') }}">Forgot password?</a>
          <a href="{{ url_for('register') }}">Create account</a>
        </div>
      </form>
    </section>
  {% endif %}
</div>
{% endblock %}
